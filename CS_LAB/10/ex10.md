# Exercise 10: Virtual Machine File Transfer

**Date:** _______________

**Aim:** To transfer files from one virtual machine to another virtual machine.

## Algorithm

1. **Shared Folder Configuration:**
   - Access VMware virtual machine settings
   - Enable shared folders functionality
   - Configure folder sharing between host and guest OS
   - Set appropriate permissions and attributes

2. **Host-Guest Communication Setup:**
   - Install VMware Tools for enhanced integration
   - Configure shared folder paths and mounting points
   - Verify connectivity between host and guest systems

3. **File Operations:**
   - Create directories in shared space
   - Copy files between host and guest systems
   - Move and organize files within shared folders
   - Verify file integrity after transfer

4. **Cross-Platform Verification:**
   - Confirm file accessibility from both systems
   - Test file permissions and ownership
   - Validate content consistency across platforms

## Concept

- **Virtual Machine Communication:** Methods for data exchange between virtual and physical systems
- **Shared Folders:** VMware feature enabling seamless file sharing between host and guest OS
- **HGFS (Host-Guest File System):** VMware's file system protocol for shared folder access
- **Cross-Platform File Systems:** Supporting file operations across different operating systems
- **VMware Tools:** Enhanced drivers and utilities for improved VM functionality

## Detailed Procedure

### Step 1: VMware Configuration

#### Access Virtual Machine Settings

1. Open VMware Workstation
2. Login to Ubuntu virtual machine
3. Right-click on "Ubuntu 64-bit" from the left panel
4. Select "Settings" from context menu

#### Configure Shared Folders

1. Navigate to "Options" tab in Virtual Machine Settings
2. Click on "Shared Folders" option
3. Select "Always enabled" radio button
4. Click "Add" to create new shared folder

#### Add Shared Folder Wizard

1. Click "Next" in the Add Shared Folder wizard
2. Click "Browse" to select host folder for sharing
3. Choose desired folder from host filesystem
4. Click "Next" to proceed

#### Set Folder Attributes

1. In "Specify Shared Folder Attributes" dialog
2. Check "Enable this share" checkbox
3. Configure read/write permissions as needed
4. Click "Finish" to complete setup
5. Click "OK" to close Virtual Machine Settings

### Step 2: Guest OS Configuration

#### Verify Shared Folder Access

```bash
# Login to Ubuntu and open terminal
# Check available shared folders
ubuntu@ubuntu:~$ vmware-hgfsclient
Linux_shared_files
```

#### Navigate to Shared Directory

```bash
# Access shared folders through mount point
ubuntu@ubuntu:~$ cd /mnt/hgfs/
ubuntu@ubuntu:/mnt/hgfs$ ls
Linux_shared_files

# Alternative path for newer VMware versions
# /computer/mnt/hgfs/Linux_shared_files
```

### Step 3: File Operations

#### Create Directory Structure

```bash
# Navigate to shared folder
ubuntu@ubuntu:~$ cd /mnt/hgfs/Linux_shared_files/

# Create new directory
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ mkdir hadoop

# Verify directory creation
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ ls
h1 hadoop Hadoop_1
```

#### Move Files Between Directories

```bash
# Move file to newly created directory
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ mv Hadoop_1 /mnt/hgfs/Linux_shared_files/hadoop/

# Verify file movement
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ ls
h1 hadoop

# Check contents of hadoop directory
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ ls hadoop/
Hadoop_1
```

#### Copy and Create Files

```bash
# Copy file with new name
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ cp h1 hadoop_commands.txt

# Verify copy operation
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ ls
h1 hadoop hadoop_commands.txt

# Check file contents
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ cat h1
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ cat hadoop_commands.txt
```

## File Transfer Methods

### Method 1: VMware Shared Folders (Recommended)

- Seamless integration between host and guest
- Real-time synchronization
- No network configuration required
- Built-in security through VMware Tools

### Method 2: SCP (Secure Copy Protocol)

```bash
# Transfer file from VM1 to VM2
scp /path/to/file username@vm2_ip:/destination/path

# Transfer directory recursively
scp -r /path/to/directory username@vm2_ip:/destination/path
```

### Method 3: Network File Sharing

```bash
# Using SMB/CIFS shares
sudo mount -t cifs //host_ip/share_name /mnt/shared -o username=user

# Using NFS (Network File System)
sudo mount -t nfs host_ip:/export/path /mnt/nfs
```

## Sample Commands and Output

```bash
# Initial setup verification
ubuntu@ubuntu:~$ vmware-hgfsclient
Linux_shared_files

# Directory operations
ubuntu@ubuntu:~$ cd /mnt/hgfs/Linux_shared_files/
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ ls -la
total 16
drwxrwxrwx 1 root root  4096 Oct 14 10:30 .
drwxr-xr-x 3 root root  4096 Oct 14 10:25 ..
-rw-rw-rw- 1 root root   256 Oct 14 10:20 h1
-rw-rw-rw- 1 root root  1024 Oct 14 10:25 Hadoop_1

# Create directory and move files
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ mkdir hadoop
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ mv Hadoop_1 hadoop/
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ cp h1 hadoop_commands.txt

# Final verification
ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ ls -la
total 20
drwxrwxrwx 1 root root  4096 Oct 14 10:35 .
drwxr-xr-x 3 root root  4096 Oct 14 10:25 ..
-rw-rw-rw- 1 root root   256 Oct 14 10:20 h1
drwxrwxrwx 1 root root  4096 Oct 14 10:32 hadoop
-rw-rw-rw- 1 root root   256 Oct 14 10:35 hadoop_commands.txt

ubuntu@ubuntu:/mnt/hgfs/Linux_shared_files$ ls hadoop/
Hadoop_1
```

## Verification Steps

### Host System Verification

1. Open Windows File Explorer
2. Navigate to shared folder location
3. Verify all files and directories are visible
4. Confirm file contents match Ubuntu version

### Guest System Verification

1. Use `ls` command to list directory contents
2. Use `cat` command to verify file contents
3. Check file permissions with `ls -la`
4. Verify directory structure integrity

## Troubleshooting Common Issues

### Shared Folders Not Visible

```bash
# Reinstall VMware Tools
sudo apt-get update
sudo apt-get install open-vm-tools

# Manual mount if needed
sudo mount -t vmhgfs .host:/ /mnt/hgfs
```

### Permission Issues

```bash
# Fix permissions
sudo chmod -R 755 /mnt/hgfs/Linux_shared_files
sudo chown -R $USER:$USER /mnt/hgfs/Linux_shared_files
```

### Mount Point Issues

```bash
# Create mount point if missing
sudo mkdir -p /mnt/hgfs

# Add to fstab for persistent mounting
echo '.host:/ /mnt/hgfs vmhgfs defaults,ttl=1 0 0' | sudo tee -a /etc/fstab
```

## Security Considerations

- **Access Control:** Configure appropriate permissions for shared folders
- **Network Security:** Use encrypted protocols (SCP, SFTP) for network transfers
- **File Integrity:** Verify file checksums after transfer operations
- **Backup Strategy:** Maintain copies of critical files before transfer operations

## Performance Optimization

- **Transfer Size:** Use compression for large file transfers
- **Network Bandwidth:** Consider transfer timing for network-based methods
- **Resource Usage:** Monitor CPU and memory during large transfers
- **Batch Operations:** Group multiple file operations for efficiency

## Advanced File Transfer Techniques

### Using rsync for Efficient Transfers

```bash
# Synchronize directories with progress
rsync -avz --progress /source/directory/ username@remote:/destination/

# Resume interrupted transfers
rsync -avz --partial --progress /source/ username@remote:/destination/
```

### Using tar for Archive Transfers

```bash
# Create and transfer compressed archive
tar -czf - /source/directory | ssh username@remote 'tar -xzf - -C /destination/'

# Transfer with progress indication
tar -czf - /source/directory | pv | ssh username@remote 'tar -xzf - -C /destination/'
```

### Network-based Transfers

```bash
# Using netcat for direct file transfer
# On receiving VM:
nc -l -p 9999 > received_file.txt

# On sending VM:
nc destination_ip 9999 < file_to_send.txt
```

## Best Practices

1. **Pre-transfer Verification:** Check available disk space on destination
2. **Backup Important Data:** Create backups before major file operations
3. **Test Small Files First:** Verify transfer process with small test files
4. **Monitor System Resources:** Watch CPU, memory, and network usage
5. **Document Transfer Procedures:** Maintain records of transfer methods used

## Result

Thus the implementation of file transfer from one virtual machine to another virtual machine was executed successfully.

---

**Exercise completed:** _______________